                        SPLEX
Statistiques pour la classification et fouille de donneÌes
                     en geÌnomique
       Classification probabiliste - Classification LineÌaire Binaire



                       Pierre-Henri WUILLEMIN

                             Decision-axe IA-LIP6
                       pierre-henri.wuillemin@lip6.fr
   Rappels : Variables aleÌatoires et probabiliteÌs

    Soient X et Y deux variables aleÌatoires sur â„¦.

    â½ DeÌfinition
             loi marginale de X
             p(X = x) = p({X = x} | â„¦)
             loi jointe de X et Y
             p(X = x, Y = y ) = p({X = x} âˆ© {Y = y } | â„¦)
             loi conditionnelle de X sachant Y
             p(X = x | Y = y ) = p({X = x} | {Y = y } , â„¦)


    ProprieÌteÌ
                                       P
                                             p(X = x | Y = y )                       =1
                                         x
                                       P
                                             p(X = x | Y = y )                       Ì¸= 1
                          P              y
                               p(X = x, Y = y | Z = z)                               = p(Y = y | Z = z)
                           x




SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   2 / 33
   Rappels : ProbabiliteÌs, fonctions â€” theÌoreÌ€me de Bayes


             p(X = x|Y = y ) âˆˆ [0, 1] est une probabiliteÌ.
             p(X |Y = y ) est une distribution de probabiliteÌ (une fonction).
             p(X |Y ) est une famille de distributions de probabiliteÌs sur des espaces diffeÌrents.
    Il y a une diffeÌrence de nature entre p(X | Y ) et p(Y | X ). On connaÄ±Ì‚t neÌanmoins un rapport entre ces
    grandeurs :p(X , Y ) = p(X | Y ) Â· p(Y ) = p(Y | X ) Â· P(X )




    TheÌoreÌ€me (de Bayes)
                                                                               p(Y | X ) Â· p(X )
                                                        p(X | Y ) =
                                                                                    p(Y )
                                            p(Y |X ,Z )Â·p(X |Z )
    ou encore : p(X | Y , Z ) =                  p(Y |Z )




SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   3 / 33
   Rappels : Variables aleÌatoires et indeÌpendances

    Soient X , Y et Z des variables aleÌatoires sur â„¦.

    â½ DeÌfinition (IndeÌpendance conditionnelle)
              Y | Z selon p si et seulement si p(X |Y , Z ) = p(X |Z )
        |=




    X

    â½ DeÌfinition (indeÌpendance marginale)
              Y selon p si et seulement si p(X |Y ) = p(X )
        |=




    X

    p(X |Y , Z ) = p(X |Z ) peut se lire :
    Augmenter notre eÌtat de connaissance Z en apprenant Y nâ€™influence pas la distribution de probabiliteÌ quâ€™on
    attribue aÌ€ X .

                                                                          Y | Z si et seulement si Y               X |Z.
                                                                     |=




                                                                                                              |=
    AÌ€ noter que cette relation est symeÌtrique : X


                                          Y alors p(X , Y ) = p(X | Y ) Â· p(Y ) = p(X ) Â· p(Y )
                                     |=




    On remarque que, si X
                               Y | Z alors p(X , Y | Z ) = p(X | Y , Z ) Â· p(Y | Z ) = p(X | Z ) Â· p(Y | Z )
                          |=




    De meÌ‚me, si X



SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   4 / 33
   Approche probabiliste de la classification

    Soient, aÌ€ nouveau, deux v.a. X (de dimension d) discreÌ€te et Y (de dimension 1)
    discreÌ€te (pas forceÌment binaire).
    Sur la base Î a , on peut estimer les probabiliteÌs par des freÌquences pour P(X , Y ).
    Soit x une instantiation de X , on cherche sa classe y (valeur de Y ).

      1    Maximum de vraisemblance
                                                             âˆ—
                                                            yML = arg max P(x | yi )
                                                                                   yi


      2    Maximum a posteriori
                                                           âˆ—
                                                          yMAP = arg max P(yi | x)
                                                                                    yi

    Dâ€™apreÌ€s la reÌ€gle de Bayes, P(Y | X ) âˆ P(X | Y ) Â· P(Y ), on comprend que lâ€™inteÌreÌ‚t du MAP est de prendre
    en compte un a priori sur la freÌquence de chaque classe.

               Il peut eÌ‚tre difficile dâ€™obtenir ces distributions.
               ParticulieÌ€rement : P(X | Y ) peut demander beaucoup dâ€™observation ! !

SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   5 / 33
   Exo 1 : francÌ§ais ou sueÌdois ?
    On consideÌ€re deux attributs pour deÌterminer la nationaliteÌ dâ€™un individu.
    Lâ€™attribut taille qui peut prendre les valeurs grand ou petit, lâ€™attribut couleur des
    cheveux qui peut prendre les valeurs brun ou blond. Les nationaliteÌs possibles sont
    francÌ§ais et sueÌdois.
    On suppose que les populations francÌ§aises et sueÌdoises se reÌpartissent selon le
    tableau suivant :
                   petit, brun petit, blond grand, brun grand, blond
      SueÌdois         10           20              30             40
      FrancÌ§ais        25           25              25             25
        1    Dans une assembleÌe comprenant 60% de sueÌdois et 40% de francÌ§ais, deÌcrire
                  1   la reÌ€gle de deÌcision majoritaire
                  2   la reÌ€gle du maximum de vraisemblance
                  3   la reÌ€gle de Bayes
        2    Calculez les probabiliteÌs dâ€™erreur de chacune de ces reÌ€gles
        3    On suppose maintenant que lâ€™on ne connaÄ±Ì‚t plus les proportions respectives
             des sueÌdois et des francÌ§ais. On note p la proportion des sueÌdois (p âˆˆ [0, 1]).
             DeÌcrire, selon les valeurs possibles de p , les reÌ€gles de Bayes
             correspondantes.
SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   6 / 33
   Classifieur BayeÌsien NaÄ±Ìˆf
    Il peut eÌ‚tre difficile dâ€™obtenir P(Y ), P(X | Y ), P(Y | X ).
    ParticulieÌ€rement : P(X | Y ) peut demander beaucoup dâ€™observation ! !

    HypotheÌ€se du classifieur bayeÌsien naÄ±Ìˆf
    On supposera que, âˆ€k Ì¸= l, X k                                  Xl |Y



                                                              |=
    Cette hypotheÌ€se est treÌ€s forte. Elle a peu de chance de sâ€™avouer exacte dans un cas reÌel. NeÌanmoins cette
    approximation donne des reÌsultats souvent satisfaisants.


    Alors, le calcul du MAP sâ€™eÌcrit :
      3    Maximum a posteriori
                                                                                                                   !
                                                                                         Y
                                                                                         d
                                               y = arg max P(yi ) Â·                             P(x | yi )
                                                                                                        k
                                                                  yi
                                                                                         k=1



    Cette hypotheÌ€se permet donc de simplifier fortement les calculs neÌcessaires pour
    estimer le MAP.

SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   7 / 33
   Cas gaussien
  Cadre
                                                           
           ModeÌ€le : Cb(x) = Ïƒ (g (x)) = Ïƒ g â—‹
                                             + (x) âˆ’ gâ—‹
                                                      - (x)
           ReÌgions de deÌcision :
           âˆ€c âˆˆ â—‹, ^- â—‹
                      +^ , Rc = x âˆˆ D, Cb(x) = c

           FrontieÌ€re de deÌcision : F = x âˆˆ D, Cb(x) = 0
           MultinormaliteÌ : âˆ€c âˆˆ {â—‹,
                                   - â—‹},
                                      + gc (x) = P(x | c) âˆ¼ N (Âµc , Î£c )

    â½ DeÌfinition (DensiteÌ normale)
                                                                1                1           t   âˆ’1
                                        p(x) =                   d       1
                                                                             e âˆ’ 2 (xâˆ’Âµ) Î£            (xâˆ’Âµ)
                                                                                                                 ouÌ€
                                                       (2Ï€) |Î£|  2       2



             Âµ le vecteur des moyennes,

             Î£ la matrice de covariance :
                      âˆ€i, j âˆˆ {1, Â· Â· Â· , d} , Î£[i,j] = cov (Xi , Xj ) et Î£[i,i] = var (Xi )
                      Î£ semi-deÌfinie positive (âˆ€x, x t Î£x â‰¥ 0)
                      |Î£| â‰¥ 0 et Î£âˆ’1 existe
SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   8 / 33
                     Un exemple

                           Les donnÃ©es â€“les couples (gÃ¨nes 1, gÃ¨ne 2) â€“ suivent un
                           certain modÃ¨le : deux distributions de probabilitÃ© sur DX
                           (une pour chaque classe).
                                             10000
                                                                                                               classe ALL
                                                                                                               classe AML
                                              9000                                                                Nouveau


                                              8000


                                              7000


                                              6000


                                              5000


                                              4000


                                              3000


                                              2000


                                              1000


                                                 0
                                                     0         500          1000         1500         2000          2500         3000
                                                                                                                                             DM - 04/05 - â€“ p. 2




SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire                  9 / 33
                     Le classifieur BayeÌsien naÄ±Ìˆf - 1

                           DonnÃ©es :
                               â€¢ lâ€™ensemble dâ€™apprentissage X = (x1 , x2 , Â· Â· Â· , xn ) oÃ¹
                                   xi = (vi1 , vi2 , Â· Â· Â· , vip )
                               â€¢ un nouvel Ã©lÃ©ment x = (v1 , Â· Â· Â· , vp )

                           ProblÃ¨me : trouver la classe de x.
                           Approche probabiliste :


                                                                                                 P (x|c)P (c)
                           cM AP = argmaxc P (c|x) = argmaxc                                                  = argmaxc P (x|c)P
                                                                                                    P (x)

                           Il faut estimer les probabilitÃ©s P (c) et P (x|c) Ã  partir de X.



                                                                                                                                             DM - 04/05 - â€“ p. 2




SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire                10 / 33
                     Le classifieur BayeÌsien naÄ±Ìˆf - 2

                               â€¢ Estimation de P (c)

                                                                    P (0) = n0 /n = 27/38
                                                                    P (1) = n1 /n = 11/38
                               â€¢ Le problÃ¨me est plus compliquÃ© pour P (x|c)

                           Approche naÃ¯ve Bayes : les attributs sont indÃ©pendants
                           Ã©tant donnÃ©e la classe :

                                                                P (x|c) = P (g1 |c)P (g2 |c)

                           Il faut estimer P (g1 |c) et p(g2 |c) Ã  partir de X.



                                                                                                                                             DM - 04/05 - â€“ p. 2




SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire                11 / 33
                     Le classifieur BayeÌsien naÄ±Ìˆf - 3

                           HypothÃ¨se de normalitÃ© :
                               â€¢ P (g1 |c)               N (g1 , Âµg1 ,c , Ïƒg21 ,c )
                               â€¢ P (g2 |c)               N (vp , Âµg2 ,c , Ïƒg22 ,c )
                           On nâ€™a plus quâ€™a estimer les moyennes et Ã©cart-types Ã 
                           partir de X.

                                                  Âµg1 ,0 â‰ˆ 810.29                               Ïƒg1 ,0 â‰ˆ 338.17
                                                 Âµg1 ,1 â‰ˆ 1836.27                               Ïƒg1 ,1 â‰ˆ 360.88

                                                 Âµg1 ,0 â‰ˆ 3863.29                               Ïƒg1 ,0 â‰ˆ 1999.78
                                                  Âµg1 ,0 â‰ˆ 702.36                               Ïƒg1 ,0 â‰ˆ 360.34


                                                                                                                                             DM - 04/05 - â€“ p. 2




SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire                12 / 33
                     Le classifieur BayeÌsien naÄ±Ìˆf - 4

                    0.0012                                             classe ALL          0.0014
                                                                       classe AML                                                              classe ALL
                                                                                                                                               classe AML

                                                                                           0.0012
                    0.001


                                                                                            0.001
                    0.0008

                                                                                           0.0008
                    0.0006

                                                                                           0.0006

                    0.0004
                                                                                           0.0004


                    0.0002
                                                                                           0.0002


                        0                                                                      0



                             0     500      1000      1500      2000       2500     3000            0   1000   2000    3000   4000   5000    6000       7000      8000



                                 Fumarylacetoacetate                                                                  C-myb




                                                                                                                                                    DM - 04/05 - â€“ p. 2




SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire                       13 / 33
                     Le classifieur BayeÌsien naÄ±Ìˆf - 5

                           On veut dÃ©terminer la classe de x = (1000, 1500) :

                                                                                                
                                P (0|x) = P (0)N 1500, Âµg1 ,0 , Ïƒg21 ,0 N 4000, Âµg2 ,0 , Ïƒg22 ,0
                                        = 0.71053 Ã— 1.01 10âˆ’3 Ã— 9.92 10âˆ’5 = 7.11 10âˆ’8
                                                                                                
                                P (1|x) = P (1)N 1500, Âµg1 ,1 , Ïƒg21 ,1 N 4000, Âµg2 ,1 , Ïƒg22 ,1
                                                 = 0.28947 Ã— 7.54 10âˆ’5 Ã— 9.55 10âˆ’5 = 2.09 10âˆ’9
                            â‡’ cM AP              = 0




                                                                                                                                             DM - 04/05 - â€“ p. 2




SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire                14 / 33
   Classification lineÌaire binaire (CLB)
                                                  â½ DeÌfinition (CLB)
                                                                              C = {â—‹,
                                                                                   - â—‹}
                                                                                      +
                                                          Î 
                                                                              âˆƒw âˆˆ Rd , w0 âˆˆ R, âˆƒf : R â†’ C,
                                                 D(.)           C (.)
                                                                                                                                                    !
                                                                                                                           X
                                                                                                                           d
                                                  D
                                                        Cb(.)
                                                                   C
                                                                                   âˆ€x âˆˆ R , Cb(x) = f
                                                                                                 d
                                                                                                                                   wi Â· x i + w 0
                                                                                                                            i=1

                                                  Le probleÌ€me dâ€™apprentissage : trouver w , w0 et f .

    ModeÌ€les geÌneÌratifs, modeÌ€les discriminants
             ModeÌ€les geÌneÌratifs : classification graÌ‚ce aÌ€ une estimation de P(x, y ) aÌ€
             partir de Î a et des connaissances a priori.
                      Classifieur bayeÌsien (ML, MAP)
                      Classifieur bayeÌsien naÄ±Ìˆf
                      Discriminant lineÌaire de Fisher
             ModeÌ€les discriminants : estimation directe des w , w0 aÌ€ partir de Î a .
                      ReÌgression logistique
                      Perceptron
                      SVM
SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire          15 / 33
   Le classifieur bayeÌsien naÄ±Ìˆf binaire est un CLB ?
    Classifieur bayeÌsien naÄ±Ìˆf
                                                                                                                   !
                                                                                         Y
                                                                                         d
                                               y = arg max P(yi ) Â·                             P(x k | yi )
                                                                  yi
                                                                                         k=1

             Ici, y0 = â—‹
                       - et y1 = â—‹.
                                 +
                                                 Qd
                                      P( â—‹)Â·
                                         +                 P(x k | â—‹)
                                                                   +
             Soit R(x) = P(â—‹)Â·Qdk=1
                           -        P(x k |â—‹)
                                           -         k=1

             Si R(x) > 1 alors Cb(x) = â—‹
                                       ^ sinon Cb(x) = â—‹
                                       +               ^-
                                                  ï£±
                                                  ï£´
                                                  ï£²âˆ’1 si u < 0
                     b
             Donc C (x) = Ïƒ (log R(x)) ouÌ€ Ïƒ(u) = 0      si u = 0
                                                  ï£´
                                                  ï£³
                                                   +1 sinon
             Il vient alors
                                                                                                                               !
                                                          P( â—‹)
                                                             +                              X
                                                                                            d
                                                                                                       P(x k | â—‹)
                                                                                                               +
                                            Cb(x) = Ïƒ log       +                                  log
                                                          P(â—‹)
                                                             -                                         P(x | â—‹)
                                                                                                           k   -
                                                                                            k=1

    Suite eÌvidente dans le cas binomial (D = {â—‹,
                                               - â—‹}
                                                  + )).                     d

SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   16 / 33
   Discrimination lineÌaire - cas gaussien
   Cadre gaussien
                                                            
            ModeÌ€le : Cb(x) = Ïƒ (g (x)) = Ïƒ g â—‹
                                              + (x) âˆ’ gâ—‹
                                                       - (x)
            ReÌgions de deÌcision :
            âˆ€c âˆˆ â—‹, ^- â—‹
                       +^ , Rc = x âˆˆ D, Cb(x) = c

            FrontieÌ€re de deÌcision : F = x âˆˆ D, Cb(x) = 0
            MultinormaliteÌ : âˆ€c âˆˆ {â—‹,
                                    - â—‹},
                                       + P(x | c) âˆ¼ N (Âµc , Î£c )

    CLB
    Si homosceÌdasticiteÌ : âˆ€c, Î£c = Î£ alors, la fonction discriminante devient
    lineÌaire :
                                                                                   t
                                              g (x) = Âµ â—‹
                                                        + âˆ’ Âµâ—‹
                                                             -                          Î£âˆ’1 (x âˆ’ x0 )
                                                                                                                          
                                                                                             â—‹)
    avec x0 = 12              Âµâ—‹
                               + + Âµâ—‹
                                    - +
                                                                         1
                                                                       t âˆ’1            log P( +
                                                                                           P(â—‹)
                                                                                              -                                (Âµ â—‹
                                                                                                                                  + âˆ’ Âµâ—‹
                                                                                                                                       - )
                                                             (Âµ â—‹   - ) Î£
                                                                + âˆ’Âµâ—‹       (Âµ â—‹   - )
                                                                               + âˆ’Âµâ—‹



SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   17 / 33
   Rappels de geÌomeÌtrie
                       Pd
    Soit y (x) =          i=1 wi Â· xi + w0 â‡’ C (x) = f (y (x)), on peut eÌgalement eÌcrire :
                                                       b


                y (x) = w â€² Â· x + w0                              avec y (x) = 0 lâ€™eÌquation dâ€™un hyperplan H

    âˆ€a, b âˆˆ H, y (a) = y (b) = 0 â‡’ y (a) âˆ’ y (b) = w â€² Â· (a âˆ’ b) = 0


                                                      w est un vecteur normal aÌ€ H.

    Soit x Ì¸âˆˆ H et xH sa projection perpendiculaire sur H, x âˆ’ xH est donc colineÌaire aÌ€ w ,
                                w
    Soit r âˆˆ R, x âˆ’ xH = r âˆ— ||w  ||
                                     ouÌ€ r est la distance de x aÌ€ H.
                                                    w
                                  x = xH + r Â·
                                                  ||w ||
                                          â€²            â€²                wâ€² Â·w      â€²           ||w ||2    â€²
                                       w Â· x = w Â· xH + r Â·                     = w Â· xH + r Â·         = w Â· xH + r Â· ||w ||
                                                                         ||w ||                 ||w ||
                                 â€²                     â€²
                   y (x) = w Â· x + w0 = w Â· xH + w0 + r Â· ||w || = y (xH ) + r Â· ||w || = r Â· ||w ||



                                                                                                  y (x)
                                                  distance de x aÌ€ H : r =
                                                                                                  ||W ||

SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   18 / 33
   Rappels de geÌomeÌtrie


                                      y (x) > 0




                                  y (x) = 0


                                                                         y (x)
                                                                         ||w ||


                                                                                                           x
                                      y (x) < 0


                                                                                                    xH
                                                                     w




                                               O
                                                                             âˆ’w0
                                                                             ||w ||



SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   19 / 33
   exemple : Hyper-plan seÌparateurs
                                                                           Pd
    La frontieÌ€re entre les deux classes est donneÌe par                       i=1 wi Â· xi + w0 = 0 qui est lâ€™eÌquation dâ€™un hyper-plan.
    Comment choisir cet hyper-plan ?



    Exemple : CLB par reÌgression lineÌaire
             Ajuster un modeÌ€le lineÌaire l^k pour chaque
                                                         fonction indicatrice dâ€™une classe k :
                                                          1 si x est de classe k
                          âˆ€k âˆˆ { â—‹,+ â—‹}  - , l^k (x) =
                                                          0 sinon.
                         ^
                         lâ—‹
                          + (x) = Î² â—‹0 + +Î²
                                                  â€²
                                                    Â· x et l^â—‹
                                                             - (x) = Î²â—‹0
                                                                      - +Î²
                                                                             â€²
                                                                               Â·x
                                                                          â—‹
                                                                          +                                                 â—‹
                                                                                                                            -

             Soit un x aÌ€ classifier : Cb(x) = arg maxk l^k (x) = Ïƒ(l^â—‹   ^- )
                                                                      + âˆ’ lâ—‹
    FrontieÌ€re de deÌcision :                                ï£±
                                                             ï£´
                                                             ï£²w =                                            Î²â—‹
                                                                                                              + âˆ’ Î²â—‹
                                                                                                                   -

                                         - (x) â‡’ hyperplan :
                               ^
                               fâ—‹       ^
                                + (x) = fâ—‹                     et
                                                             ï£´
                                                             ï£³
                                                               w0 =                                          Î² â—‹0
                                                                                                               + âˆ’ Î²â—‹0
                                                                                                                    -




SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   20 / 33
   SeÌparabiliteÌ


                                                  â½ DeÌfinition (CLB)
                                                                              C = {â—‹,
                                                                                   - â—‹}
                                                                                      +
                                                          Î 
                                                                              âˆƒw âˆˆ Rd , w0 âˆˆ R, âˆƒf : R â†’ C,
                                                 D(.)           C (.)
                                                                                                                                                    !
                                                                                                                           X
                                                                                                                           d
                                                  D
                                                        Cb(.)
                                                                   C
                                                                                   âˆ€x âˆˆ R , Cb(x) = f
                                                                                                 d
                                                                                                                                   wi Â· x i + w 0
                                                                                                                            i=1

                                                  Le probleÌ€me dâ€™apprentissage : trouver w , w0 (W) et f (souvent Ïƒ).



    SeÌparabiliteÌ sur Î a
    Soit une base de donneÌes Î a = (xi , yi )i<N ouÌ€ yi est la classe de xi (âˆˆ âˆ’1, +1).
    Î a est lineÌairement seÌparable si il existe un hyperplan dâ€™eÌquation
    y (x) = w â€² Â· x + w0 = 0) tel que

                              âˆ€i âˆˆ {1, Â· Â· Â· , N}, y (xi ) Â· yi > 0 i.e. (X Â· W) Ã— Y > 0

SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire          21 / 33
   Optimisation de W : moindres carreÌs
                                        X Â· W âˆ’ Y est le vecteur des erreurs effectueÌes en classant Î a
                                     aÌ€ lâ€™aide de W.
                                        Lâ€™erreur quadratique obtenue sur Î a se calcule donc comme :
                                                                                                          â€²
                                                               e 2 (W) = (X Â· W âˆ’ Y) Â· (X Â· W âˆ’ Y)
        Carl Friedrich Gauss

        Minimiser cette erreur en annulant le gradient donne :
                                                                              âˆ’1
                                                 Wâˆ— = (X â€² Â· X)                     Â· X â€² Â· Y = Xâ€  Â· Y
                        âˆ’1
    Xâ€  = X â€² Â· X               Â· X â€² est la pseudo-inverse de X .




        Cette meÌthode souffre de plusieurs
       probleÌ€mes :
                InstabiliteÌ numeÌrique (pour des X de
                grande taille principalement),
                Manque de robustesse pour des
                distributions larges de classes.


                                                                                    From : Pattern Recognition and Machine Learning â€“ C.Bishop â€“ p186
SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire         22 / 33
   Discrimants de Fisher : seÌparation entre les classes
       On note que y = w â€² Â· x correspond aÌ€ la projection de x (de dimension d + 1) sur la droite vectorielle w.
                    1
                       P                        1
                                                   P
       Soit M â—‹
              + = N          + Xi et Mâ—‹
                          iâˆˆ â—‹          - = N         iâˆˆâ—‹- Xi
                            â—‹
                            +                                    â—‹
                                                                 -

       On peut alors utiliser âˆ†w = w â€² Â· M â—‹
                                                  
                                           + âˆ’ Mâ—‹
                                                -   comme mesure de la seÌparation des classes selon w.
                                                                                                       âˆ†w
    Afin de supprimer lâ€™influence sur âˆ†w de la norme de w, on peut soit normaliser w, soit utiliser         comme mesure.
                                                                                                      ||w||




                                               From : Pattern Recognition and Machine Learning â€“ C.Bishop â€“ p188

     La seÌparation des classes nâ€™est inteÌressante quâ€™en fonction de la dispersion de chaque classe, i.e.
                       P              â€²
    âˆ€k âˆˆ â—‹,
         + â—‹,  - sk =                          2
                          iâˆˆk (yi âˆ’ w Â· Mk ) les variances intra-classe.

SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   23 / 33
   De la reÌgression lineÌaire vers la reÌgression logistique

    ReÌgression lineÌaire
                                                                 y^(x) = w â€² Â· x + w0
    FrontieÌ€re de seÌparation : hyperplan dâ€™eÌquation y (x) = w â€² Â· x + w0 = 0
    En reÌutilisant MAP pour deÌcider :
                                                               y^ = arg        max        p(c | x)
                                                                            câˆˆ{ â—‹,
                                                                                + â—‹}
                                                                                   -


    On ne peut pas ajuster lineÌairement une probabiliteÌ : une droite nâ€™est pas borneÌe par [0, 1].
    IdeÌe : La frontieÌ€re de deÌcision correspond aÌ€

                                                                           p( â—‹
                                                                              + | x)            p( â—‹
                                                                                                   + | x)
                                p( â—‹
                                   + | x) = p(â—‹
                                              - | x) â‡â‡’                              = 1 â‡â‡’ log           =0
                                                                           p(â—‹- | x)            p(â—‹- | x)

    On peut renforcer lâ€™ideÌe que la frontieÌ€re est un hyperplan (CLB) par :


    ReÌgression logistique
                                                                    p( â—‹
                                                                       + | x)
                                            âˆƒw , w0 , log                     = w â€² Â· x + w0
                                                                    p(â—‹- | x)

SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   24 / 33
   fonction logit
                           â—‹|x)        p( â—‹|x)
    On peut eÌcrire log p( +
                        p(â—‹|x)
                           -    = log 1âˆ’p(+
                                           â—‹|x)
                                           +



                   Fonction logit (log-odds)
                                                          p
                             logit(p) = log
                                                         1âˆ’p


   La fonction logit est non borneÌe et donc peut
   eÌ‚tre ajuster lineÌairement.
                                                                               â€²                                     w â€² Â·x+w0
    logit(p) = w â€² Â· x + w0 â‡â‡’ 1âˆ’p
                                p
                                   = e w Â·x+w0 â‡â‡’ p = 1+e
                                                       e
                                                          w â€² Â·x+w0



                  ModeÌ€le de la reÌgression logistique
                                                                â€²
                                             e w Â·x+w0                         1
                               p( â—‹
                                  + | x) =                 et p(â—‹
                                                                - | x) =
                                           1 + e w â€² Â·x+w0               1 + e w â€² Â·x+w0


SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   25 / 33
   Utilisation de la reÌgression logistique

    Soit une base Î a = (Xi , Yi ) avec Yi âˆˆ { â—‹,   + â—‹},
                                                     -
    On peut calculer pour chacun w â€² Â· x + w0 ,
                                       â€²
                                    e w Â·x+w0
    et donc calculer p( â—‹
                        + | x) = 1+e   w â€² Â·x+w0 .




SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   26 / 33
   Estimation des parameÌ€tres w , w0

    Comment calculer les valeurs de w et w0 de la reÌgression logistique ?

       Moindre carreÌs ? Impossible car les erreurs ne sont pas distribueÌes suivant une
    loi normale : Elle est quasi nulle quand p proche de 0 ou 1 et plus importante
    quand p â‰ˆ 0.5.

        Utilisation du Maximum de Vraisemblance :
          Exprimer la vraisemblance L(X ; w , w0 ) pour w et w0 ,
          Essayer de maximiser la vraisemblance
          En annulant la deÌriveÌe mais pas de forme exacte de la deÌriveÌe.
          Utiliser une meÌthode approcheÌe : Algorithme de Newton-Raphson.

        Soit une base de donneÌes (X , Y )iâ‰¤N . Avec yi = 1 si â—‹      + et 0 si â—‹.-
          âˆ€i, L(xi ; w , w0 ) = yi Â· p(xi | â—‹)
                                            + + (1 âˆ’ yi ) Â· p(xi |â—‹)
                                                                  -
                         â—‹|x)                                          â—‹)
          Or si log p(   +
                      p(â—‹|x)
                          -    = w â€² Â· x + w0 alors âˆƒÎ², Î²0 , log p(x|  +
                                                                   p(x|â—‹)
                                                                       -  = Î² â€² Â· x + Î²0
                                         Î² â€² Â·x+Î²0
             p(x | â—‹)   e
                   + = 1+e Î² â€² Â·x+Î²0 et p(x | â—‹)
                                              - = 1+e Î²1â€² Â·x+Î²0


SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   27 / 33
   Estimation des parameÌ€tres Î²+ = (Î², Î²0 )

    En sommant sur toute la base la log-vraisemblance,

                                                     X
                                                     N h            â€²                  â€²
                                                                                                  i
                                 LL(Î²+ ) =                     yi Â· Î²+ Â· xi+ âˆ’ log(1 + Î²+ Â· xi+ )
                                                      i=1

    On veut maximiser la log-vraisemblance.

                                                  âˆ‚LL(Î²+ ) X
                                                             N

                                                      +   =     xi Â· (yi âˆ’ p(xi ; Î²+ )
                                                    âˆ‚Î²i     i=1

    Pas de forme simple, il faut utiliser une meÌthode approcheÌe (Newton-Raphson)
                                                âˆ‚2 LL(Î²+ )
    utilisant la deÌriveÌe seconde (le Hessien) âˆ‚Î² + âˆ‚Î²+ â€² .
                                                 +
    La mise aÌ€ jour (jusque convergence) de Î² prend la forme :
                                                                       2        âˆ’1
                                                                       âˆ‚ LL(Î²+ )       âˆ‚LL(Î²+ )
                                           Î²+      +
                                            t+1 = Î²t âˆ’                    +  + â€²     Â·
                                                                       âˆ‚Î² âˆ‚Î²             âˆ‚Î²+


SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   28 / 33
   MeÌthode de Newton (1/2)

    fonction de classe C 2
       f : [a, b] âŠ‚ R 7â†’ R
       f : 2 fois deÌrivable
       f â€²â€² continue

    MeÌthode de Newton-Raphson : recherche de 0 de la deÌriveÌe
        principe : engendrer une suite de points (x k ) tendant
        vers un point stationnaire
        point stationnaire : f â€² (x âˆ— ) = 0
        iteÌration k : f â€² est remplaceÌe par sa lineÌariseÌe en x k :
        l(x) = f â€² (x k ) + [x âˆ’ x k ]f â€²â€² (x k )
        x k+1 deÌtermineÌ par l(x k+1 ) = 0 :
                            f â€² (x k )
        =â‡’ x k+1 = x k âˆ’ â€²â€² k
                            f (x )


SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   29 / 33
   MeÌthode de Newton (2/2)



                       f â€² (x)




                                                                                                                                      x
                                                                         xk+2                xk+1                 xk




SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   30 / 33
   Un exemple (1/3)




                                                                                            From Jia Li (Pensylvania State University)



SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   31 / 33
   Un exemple (2/3)




                                                                                            From Jia Li (Pensylvania State University)



SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   32 / 33
   Un exemple (3/3)




                                                                                            From Jia Li (Pensylvania State University)


SPLEX Statistiques pour la classification et fouille de donneÌes en geÌnomique
                                                                            Classification probabiliste - Classification LineÌaire Binaire   33 / 33
